{
  "info": {
    "_postman_id": "6494a32a-e501-42ee-83f7-3262ce903d74",
    "name": "Authentication",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "_exporter_id": "41082104"
  },
  "item": [
    {
      "name": "Login",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "const jsonData = pm.response.json();",
              "const token = jsonData?.data?.token;",
              "",
              "pm.test(\"Response contains auth token\", function () {",
              "    pm.expect(token, \"Auth token should exist in response\").to.exist;",
              "});",
              "",
              "// Save token to the collection variable (modern Postman)",
              "if (token) {",
              "    pm.environment.set(\"auth_token\", token);",
              "    console.log(\"\u2705 Token saved successfully:\", token);",
              "} else {",
              "    console.error(\"\u274c Token not found in response!\");",
              "}",
              ""
            ],
            "type": "text/javascript",
            "packages": {},
            "requests": {}
          }
        }
      ],
      "request": {
        "method": "PUT",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n    \"email\": \"super.admin1@example.com\",\n    \"password\": \"Pass*&1122\"\n}"
        },
        "url": {
          "raw": "{{base_url}}/user/login",
          "host": [
            "{{base_url}}"
          ],
          "path": [
            "user",
            "login"
          ]
        }
      },
      "response": []
    }
  ],
  "auth": {
    "type": "bearer",
    "bearer": [
      {
        "key": "token",
        "value": "{{auth_token}}",
        "type": "string"
      }
    ]
  },
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "type": "text/javascript",
        "requests": {},
        "exec": [
          "const token = pm.environment.get('auth_token');",
          "",
          "if (token) {",
          "    pm.variables.set('auth_token', token);",
          "    console.log(\"\u2705 Using updated auth token:\", token);",
          "} else {",
          "    console.warn(\"\u26a0\ufe0f No stored token found!\");",
          "}",
          "",
          "// Ensure base URL exists",
          "if (!pm.variables.get('base_url')) {",
          "    pm.variables.set('base_url', 'http://localhost:8000');",
          "}",
          ""
        ]
      }
    },
    {
      "listen": "test",
      "script": {
        "type": "text/javascript",
        "packages": {},
        "requests": {},
        "exec": [
          ""
        ]
      }
    }
  ]
}